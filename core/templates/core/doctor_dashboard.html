{% extends 'core/base.html' %}
{% block content %}
<div class='container-main'>
    <h2>👨‍⚕️ Doctor Dashboard</h2>
    <div class='row'>
        <div class='col-md-4'>
            <div class='card p-3 text-center'>
                <h1 class='text-primary'>{{ pending_count }}</h1>
                <p>Pending Consultations</p>
            </div>
        </div>
        <div class='col-md-4'>
            <div class='card p-3 text-center'>
                <h1 class='text-success'>{{ active_count }}</h1>
                <p>Active Consultations</p>
            </div>
        </div>
        <div class='col-md-4'>
            <div class='card p-3 text-center'>
                <h1 class='text-danger'>{{ crisis_count }}</h1>
                <p>Crisis Alerts</p>
            </div>
        </div>
    </div>
    
    <h4 class='mt-4'>🚨 Crisis Alerts</h4>
    {% for alert in crisis_alerts %}
    <div class='card p-3 mb-2 border-danger'>
        <p><b>{{ alert.user.get_full_name }}</b> - Severity: <span class='badge bg-danger'>{{ alert.severity }}</span></p>
        <p><small>{{ alert.message|truncatewords:20 }}</small></p>
        <a href='{% url "chat" alert.consultation.id %}' class='btn btn-danger btn-sm'>Respond Immediately</a>
    </div>
    {% empty %}
    <p class='text-muted'>No crisis alerts 🎉</p>
    {% endfor %}
    
    <h4 class='mt-4'>💬 Active Consultations</h4>
    {% for consultation in active_consultations %}
    <div class='card p-3 mb-2'>
        <div class='d-flex justify-content-between'>
            <div>
                <p><b>{{ consultation.user.get_full_name }}</b></p>
                <small>{{ consultation.issue|truncatewords:15 }}</small>
            </div>
            <a href='{% url "chat" consultation.id %}' class='btn btn-primary btn-sm'>Continue Chat</a>
        </div>
    </div>
    {% empty %}
    <p class='text-muted'>No active consultations</p>
    {% endfor %}
</div>
{% endblock %}
